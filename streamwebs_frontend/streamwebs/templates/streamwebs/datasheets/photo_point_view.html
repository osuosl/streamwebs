{% extends 'streamwebs/base.html' %}
{% load staticfiles %}
{% load i18n %}
{% load filters %}
{% block content %}
<div class="container">
  <!-- PP info -->
  <div>
      <h4><a href="{% url 'streamwebs:camera_point' pp.camera_point.site.site_slug pp.camera_point.id %}">{{ pp.camera_point.site.site_name }}: camera point {{ pp.camera_point.letter }}</a></h4>
      <p><b>Date established:</b> {{ pp.pp_date|date:"m-d-Y" }}</p>
      <p><b>Compass bearing:</b> {{ pp.compass_bearing }}</p>
      <p><b>Distance from camera point {{ pp.camera_point.letter }}:</b> {{ pp.distance }}</p>
      <p><b>Camera height:</b> {{ pp.camera_height }}</p>
      <p><b>Notes:</b> {{ pp.notes }}</p>

      <strong>Photos for this photo point:</strong>
      <div class="row">
        <div class="col s12 m7">
          {% for img in pp_images %}
          <div class="card">
            <div class="card-image">
              <a href="{{ img.image.url }}" target="_blank">
                <img src="{{ img.image.url }}" alt="pp image" />
              </a>
            </div>
            <div class="card-content">
              <p><b>Date:</b> {{ img.date|date:"m-d-Y" }}</p>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
  </div>

  <!-- New photo upload -->
  <div>
      {% if user.is_authenticated %}
          {% if messages %}
              {% for msg in messages %}
              {{ msg }}
              {% endfor %}
          {% endif %}
          <h5>Add new photo</h5>
          <form id='ppi_form', method='post', enctype='multipart/form-data'>
              {% csrf_token %}
              {{ ppi_formset.as_p }}
              <button class="btn-large waves-effect waves-light teal darken-4" type="submit" name="action" value='Submit'>
                Submit
                <i class="material-icons right">send</i>
              </button>
          </form>

      {% else %}
      <a href="{% url 'streamwebs:login' %}?next={{ request.path }}">Log in to add photos for this photo point.</a>
      {% endif %}
  </div>
</div>
{% endblock %}

{% block scripts%}
  <script>
  $(document).ready(function() {
    $('.datepicker').pickadate({
      today: '',
      selectMonths: true, // Creates a dropdown to control month
      selectYears: 100, // Creates a dropdown of 15 years to control year
      max: true, // set max to today
      format: 'yyyy-mm-dd',
    });
  });
  </script>
{% endblock %}
